!function s(i,a,n){function r(o,e){if(!a[o]){if(!i[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(d)return d(o,!0);throw(t=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",t}t=a[o]={exports:{}},i[o][0].call(t.exports,function(e){return r(i[o][1][e]||e)},t,t.exports,s,i,a,n)}return a[o].exports}for(var d="function"==typeof require&&require,e=0;e<n.length;e++)r(n[e]);return r}({1:[function(e,o,t){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){c(window).on("peepso_activity_deleted",function(e,o,t){o.success&&(c(".photo-item[data-id="+t+"]").remove(),void 0!==o.data.photo_total&&o.data.photo_total<=0&&c(".ps-js-activity--"+o.data.post_act_id).remove())})}var a,n,c,l,r;a=jQuery||$,n=peepso,c=a,r=(l=n).photos=new i,i.prototype.set_as_avatar=function(e){e=jQuery.extend({user_id:peepsodata.userid,photo_id:jQuery("#photoid_tobe_photo_profile").val(),_wpnonce:jQuery("#_photoprofilenonce").val()},e||{});l.postJson("photosajax.set_photo_as_avatar",e,function(e){e.success&&window.location.reload()})},i.prototype.set_as_cover=function(e){e=jQuery.extend({user_id:peepsodata.userid,photo_id:jQuery("#photoid_tobe_photo_profile").val(),_wpnonce:jQuery("#_photoprofilenonce").val()},e||{});l.postJson("photosajax.set_photo_as_cover",e,function(e){e.success&&window.location.reload()})},i.prototype.arrange_images=_.debounce(function(){var n="photo-container-placeholder",r="ps-js-initialized";c(".ps-js-photos").not("."+r).each(c.proxy(function(e,o){var t=c(o),s=t.children(".ps-js-photo"),i=t.children(".ps-js-loading"),a=t.hasClass(n),o=s.map(function(){return c(this).find("img").data("src")});this.load_images(o).always(c.proxy(function(){i.remove(),s.each(function(){var e=c(this).find("img");e.attr("src",e.data("src")),e.removeData("src").removeAttr("data-src")}),a&&s.each(function(e,o){var t=c(o),o=t.find("img");t.data({width:o[0].naturalWidth,height:o[0].naturalHeight})}),1<s.length&&this._arrange_images(t.width()-4,s),a&&(t.css({opacity:0}).removeClass(n),t.animate({opacity:1})),t.addClass(r)},this))},this))},100),i.prototype.rearrange_images=function(){var e="ps-js-initialized";c(".photo-container").filter("."+e).removeClass(e),this.arrange_images()},i.prototype._arrange_images=function(e,o){for(var t,s,i,a,n=o.length,r=[],d=0,p=0;p<n;p++){for(r[p]=o.eq(p).data(),t=0,a=p;d<=a;a--)t+=r[a].width/r[a].height;if((s=e/t)<=180){for(a=d;a<=p;a++)o.eq(a).css({height:""}).find("img").css({height:s,marginTop:""});d=p+1}else p===n-1&&(i="height: "+s+"px",180<s&&(i+="; margin-top: -"+Math.floor((s-180)/2)+"px !important"),o.eq(d).nextAll().addBack().css({height:180}).find("img").attr("style",i))}},i.prototype.comment_attach_photo=function(e,o){var t,s,i=c(e).closest(".ps-js-comment-new,.ps-comment-edit").find(".ps-js-addons"),a=i.find(".ps-js-addon-photo");(s=a.data("initialized"))||(t=c('<input type="file" name="filedata[]" accept=".gif,.jpg,.jpeg,.png,.tif,.tiff" />').uniqueId(),(e=c("<div />").append(t)).css({position:"absolute",top:0,right:0,width:1,height:1,overflow:"hidden"}),e.insertAfter(a),t.psFileupload({formData:{user_id:peepsodata.currentuserid},singleFileUploads:!1,sequentialUploads:!1,replaceFileInput:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),dropZone:i.closest(".ps-textarea-wrapper"),pasteZone:null,dataType:"json",url:peepsodata.ajaxurl_legacy+"photosajax.upload_photo",add:c.proxy(function(e,o){this.validate_photo(o)},this),submit:function(){return a.find(".ps-js-remove").hide(),a.find(".ps-js-loading").show(),a.find(".ps-js-img").hide(),a.show(),c(document).trigger("ps_comment_addon_added",a),!0},done:c.proxy(function(e,o){o=o.result;o.success&&(a.find(".ps-js-remove").show(),a.find(".ps-js-loading").hide(),a.find(".ps-js-img").attr("src",o.data.thumbs[0]).data("id",o.data.files[0]).show(),c(document).trigger("ps_comment_addon_added",a))},this)}),s=t.attr("id"),a.data("initialized",s)),o instanceof FileList||l.isWebdriver()||c("#"+s).trigger("click")},i.prototype.validate_photo=function(o){for(var e,t=/\.(gif|jpg|jpeg|png|tif|tiff|jfif)$/i,s=0,i=0;i<o.files.length;i++){if(e=o.files[i],!t.test(e.name))return l.dialog(peepsophotosdata.error_unsupported_format,{error:!0}).show().autohide(),!1;s+=parseInt(e.size)}var a={size:s,filesize:s,photos:o.files.length},a=l.observer.applyFilters("photos_validate_req",a);l.postJson("photosajax.validate_photo_upload",a,function(e){e.success?o.submit():l.dialog(e.errors[0],{error:!0}).show().autohide()})},i.prototype.show_dialog_album=function(e){new l.PhotoAlbumDialog(e)},i.prototype.show_dialog_add_photos=function(e,o){new l.PhotoAlbumUploadDialog(e,o)},i.prototype.show_dialog_delete_album=function(e,o,t){var s=jQuery.extend({album_id:o,uid:e,_wpnonce:jQuery("#_delete_album_nonce").val()},t||{}),t=jQuery("[data-album-delete-id="+o+"]"),o="";return 0<t.size()&&(o=t.text()),pswindow.confirm_delete(function(){s=l.observer.applyFilters("photos_delete_album",s),l.postJson("photosajax.delete_album",s,function(e){e.success?window.location.reload():l.dialog(e.errors[0],{error:!0}).show().autohide()})},o),!1},i.prototype.delete_stream_album=function(e,o){var t={post_id:e,uid:peepsodata.currentuserid},e=jQuery("[data-act-delete-id="+o+"]"),o="";return 0<e.size()&&(o=e.text()),pswindow.confirm_delete(function(){t=l.observer.applyFilters("photos_delete_stream_album",t),l.postJson("photosajax.delete_stream_album",t,function(e){e.success?window.location.reload():l.dialog(e.errors[0],{error:!0}).show().autohide()})},o),!1},i.prototype.select_menu=function(e){var o=c(e.options[e.selectedIndex]),t=o.val(),e=o.data("url");(window.location+"").match(/\/requests/)&&e.match(/\/requests/)?c(".ps-js-photos-submenu").siblings(".tab-content").find("album"===t?"#album":"#latest").addClass("active").siblings().removeClass("active"):window.location=o.data("url")},i.prototype.load_image=function(i){return c.Deferred(function(e){var o=new Image;function t(){s(),e.reject(o)}function s(){o.onload=null,o.onerror=null,o.onabort=null}o.onload=function(){s(),e.resolve(o)},o.onerror=t,o.onabort=t,o.src=i}).promise()},i.prototype.load_images=function(e){var o,t=[];for("object"===s(e)&&"number"==typeof e.length||(e=[e]),o=0;o<e.length;o++)t.push(this.load_image(e[o]));return c.when.apply(c,t)},i.prototype.show_image=function(e){var o,t="ps-js-photo-popup",r=/\.gif/i,d=/\.jpe?g/i;/\.(gif|jpe?g|png)/i.test(e)&&((o=c("."+t).eq(0)).length||((o=c(peepsophotosdata.template_popup)).addClass(t).appendTo(document.body),o.on("click",".ps-lightbox-padding, .ps-lightbox-close",function(e){c(e.currentTarget).closest(".ps-lightbox").hide()}),o.on("click",".ps-lightbox-wrapper",function(e){e.stopPropagation()}),o.on("click",".ps-lightbox-play",function(e){var o=c(e.currentTarget),t=o.siblings(".ps-js-img").find("img"),s="gcis gci-play",i="gcis gci-stop",a=t.attr("src"),n=o.data("played"),e=o.data("timer-stop");n?(o.removeData("played"),o.removeClass(i).addClass(s),t.attr("src",a.replace(r,".jpg")),o.removeData("timer-stop"),clearTimeout(e)):(o.data("played",1),o.removeClass(s).addClass(i),t.attr("src",a.replace(d,".gif")),l.browser.isTouch()&&(clearTimeout(e),e=setTimeout(function(){o.removeClass(i)},1e3),o.data("timer-stop",e),t.one("click",function(){o.click()})))})),t=o.find(".ps-js-img"),r.test(e)?(e=e.replace(r,".jpg"),t.html('<img src="'+e+'" />'),t.next(".ps-lightbox-play").removeClass("gcis gci-stop").addClass("gcis gci-play").show()):(t.html('<img src="'+e+'" />'),t.next(".ps-lightbox-play").hide()),o.show())},c(document).ready(function(){c(window).on("load",function(){r.arrange_images()}),l.observer.addAction("browser.resize",function(){r.rearrange_images()}),c(document).on("ps_activitystream_loaded ps_activitystream_append peepso_repost_shown peepso_report_shown peepso_repost_added peepso_post_edit_saved peepso_messages_list_displayed ps_comment_added",function(e){"ps_activitystream_append"===e.type?setTimeout(function(){r.arrange_images()},3e3):r.arrange_images(),pswindow.is_visible&&pswindow.refresh()}),c(document).on("ps_comment_aftersave",function(e,o,t){t=c(t).closest(".ps-js-comment-new, .ps-js-comment-edit").find(".ps-js-addon-photo");t.find(".ps-js-remove").hide(),t.find(".ps-js-loading").hide(),t.find(".ps-js-img").attr("src","").removeData("id").hide(),t.hide(),c(document).trigger("ps_comment_addon_removed",t)}),c(document).on("ps_comment_save ps_lightbox_navigate",function(){r.arrange_images()}),c(document).on("click",".ps-js-addon-photo .ps-js-remove",function(){var e=c(this).closest(".ps-js-addon-photo"),o=e.find(".ps-js-img"),t=o.data("id");e.find(".ps-js-remove").hide(),e.find(".ps-js-loading").hide(),o.attr("src","").removeData("id").removeAttr("data-id").hide(),e.hide();t={user_id:peepsodata.currentuserid,photo:[t],_wpnonce:e.find("[name=_wpnonce_remove_temp_comment_photos]").val(),_wp_http_referer:e.find("[name=_wp_http_referer]").val()},t=l.observer.applyFilters("photos_remove_temp_files",t);l.postJson("photosajax.remove_temp_files",t),c(document).trigger("ps_comment_addon_removed",e)}),l.observer.addAction("comment_edit",function(e,o){var t=c(o).find(".ps-js-addon-photo"),o=t.find(".ps-js-img");o.length&&o.data("id")?(t.find(".ps-js-remove").show(),t.find(".ps-js-loading").hide(),t.find(".ps-js-img").show(),t.show(),c(document).trigger("ps_comment_addon_added",t)):(t.find(".ps-js-remove").hide(),t.find(".ps-js-loading").hide(),t.find(".ps-js-img").hide(),t.hide(),c(document).trigger("ps_comment_addon_removed",t))},10,2),c(document).on("click",".ps-lightbox .ps-js-btn-gif",function(e){var o,t=c(e.currentTarget),s=t.siblings(".ps-js-photo-gif"),i="gcis gci-play",a="gcis gci-stop",n="ps-lightbox__spinner",r=s.attr("src"),d=t.data("played"),p=t.data("timer-stop");if(e.preventDefault(),e.stopPropagation(),d)return t.removeData("played"),t.removeClass(a).addClass(i),s.attr("src",r.replace(".gif",".jpg")),t.removeData("timer-stop"),void clearTimeout(p);o=setTimeout(function(){t.addClass(n).removeClass(i)},500),r=r.replace(".jpg",".gif"),(d=new Image).onload=function(){t.data("played",1),t.removeClass(i).removeClass(n),t.addClass(a),s.attr("src",r),clearTimeout(o),l.browser.isTouch()&&(clearTimeout(p),p=setTimeout(function(){t.removeClass(a)},1e3),t.data("timer-stop",p),s.one("click",function(){t.click()}))},d.src=r})}),l.observer.addFilter("ps_photos_available",function(e){return!0},10,1),l.observer.addFilter("comment_req",function(e,o){var t,o=c(o).closest(".ps-js-comment-new,.ps-comment-edit").find(".ps-js-addon-photo");return o.is(":visible")&&(t=o.find(".ps-js-img")).length&&t.data("id")&&(e.photo=t.data("id")),e},10,2),l.observer.addFilter("comment_can_submit",function(e){var o,t=c(e.el).closest(".ps-js-comment-new, .ps-js-comment-edit").find(".ps-js-addon-photo");return t.is(":visible")&&(o=t.find(".ps-js-img")).length&&o.data("id")&&(e.can_submit=!0),e},10,1),l.observer.addFilter("comment_show_button",function(e){var o,t=c(e.el).closest(".ps-js-comment-new, .ps-js-comment-edit").find(".ps-js-addon-photo");return t.is(":visible")&&(o=t.find(".ps-js-img")).length&&o.data("id")&&(e.show=!0),e},10,1),n.observer.addAction("peepso_delete_post",function(e){a(".ps-widget--photos").find(".ps-js-photo").filter('[data-post-id="'+e+'"]').remove()},10,1),n.observer.addAction("commentbox_drop_files",function(e,o){n.photos.comment_attach_photo(e,o)},10,2),n.observer.addFilter("human_friendly_extras",function(e,o,t){return o||!t||t.querySelector(".ps-js-post-header")||(t=a(t).find(".ps-comment-media .ps-media-photos [data-preview]")).length&&e.push(t.data("preview")),e},20,3),a(function(){var e=window.location.href.match(/#(.+&)?photo=(\d+)/);e&&window.ps_comments&&ps_comments.open(+e[2],"photo")})},{}]},{},[1]);