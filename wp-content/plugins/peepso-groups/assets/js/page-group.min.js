!function a(n,i,r){function d(o,e){if(!i[o]){if(!n[o]){var t="function"==typeof require&&require;if(!e&&t)return t(o,!0);if(s)return s(o,!0);throw(t=new Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",t}t=i[o]={exports:{}},n[o][0].call(t.exports,function(e){return d(n[o][1][e]||e)},t,t.exports,a,n,i,r)}return i[o].exports}for(var s="function"==typeof require&&require,e=0;e<r.length;e++)d(r[e]);return d}({1:[function(e,o,P){(function(N){(function(){"use strict";Object.defineProperty(P,"__esModule",{value:!0}),P.default=function(){i||(i=(0,t.dialog)(o.group.template_avatar,{wide:!0,destroyOnClose:!1}).show(),r=i.$el,r.find(".ps-js-upload").on("click",W),s=function(){var e='<input type="file" name="filedata" accept="'.concat("image/*",'" data-name="').concat("group-avatar-upload",'" />'),e=(0,d.default)(e).css({position:"absolute",opacity:0,height:1,width:1});return e.appendTo(document.body),e.psFileupload({formData:{group_id:x,module_id:b,_wpnonce:D},dataType:"json",url:M,replaceFileInput:!1,add:function(e,o){var t=o.files[0];t.type.match(/image\/(jpe?g|png)$/i)?t.size>j?h.html(z).show():(h.hide(),o.submit()):h.html(A).show()},done:function(e,o){o=o.result;o.success?(Q(o.data&&o.data.image_url,o.data&&o.data.orig_image_url),T=!0,c.removeAttr("disabled")):o.errors&&h.html(o.errors[0]).show()}}),e}(),u=r.find(".ps-js-remove").on("click",C),c=r.find(".ps-js-submit").on("click",$),p=r.find(".ps-js-btn-crop").on("click",q),l=r.find(".ps-js-btn-crop-cancel").on("click",E),f=r.find(".ps-js-btn-crop-save").on("click",I),h=r.find(".ps-js-error").hide(),r.find(".ps-js-loading").hide(),v=r.find(".ps-js-has-avatar"),g=r.find(".ps-js-no-avatar"),w=r.find(".ps-js-original"),_=r.find(".ps-js-preview"),Q.apply(null,F?[o.group.img_avatar,o.group.img_avatar_original]:[]),c.attr("disabled","disabled"));return i};var e,d=(e="undefined"!=typeof window?window.jQuery:void 0!==N?N.jQuery:null)&&e.__esModule?e:{default:e},t="undefined"!=typeof window?window.peepso:void 0!==N?N.peepso:null,o="undefined"!=typeof window?window.peepsodata:void 0!==N?N.peepsodata:null;var a,n,i,r,s,u,c,p,l,f,h,v,g,w,_,m,y,j=+peepsodata.upload_size,x=+o.group.id,b=+o.group.module_id,k=o.group.img_avatar_default,D=o.group.avatar_nonce,M="".concat(peepsodata.ajaxurl_legacy,"groupajax.avatar_upload?avatar"),A=o.group.text_error_filetype,z=o.group.text_error_filesize,F=+o.group.has_avatar,T=!1,O=null;function Q(e,o){var t;e?(u.show(),g.hide(),v.show(),t="?nocache-"+(new Date).getTime(),F=!0,a=e,_.attr("src","".concat(a).concat(t)),o&&(n=o,w.attr("src","".concat(n).concat(t)))):(u.hide(),v.hide(),g.show(),F=!1,a=k,n=null,_.attr("src",a),w.removeAttr("src")),p.show(),l.hide(),f.hide()}function W(e){e.preventDefault(),s[0].value=null,s.trigger("click")}function C(e){e.preventDefault();e={group_id:x,module_id:b,_wpnonce:D};t.ajax.post("groupajax.avatar_delete",e).then(function(e){e.success&&(Q(null),i.hide(),T=!1,c.attr("disabled","disable"),t.hooks.doAction("group_avatar_updated",x,k))})}function $(e){var o;e.preventDefault(),y||(T?(o={group_id:x,module_id:b,_wpnonce:D},y=!0,t.ajax.post("groupajax.avatar_confirm",o).then(function(e){e.success&&(e=e.data&&e.data.image_url,i.hide(),T=!1,c.attr("disabled","disabled"),t.hooks.doAction("group_avatar_updated",x,e))}).always(function(){y=!1})):O?(o=d.default.extend(O,{u:x,_wpnonce:D},{tmp:"",preview:""}),y=!0,t.ajax.post("groupajax.avatar_crop",o).then(function(e){e.success&&(e.data&&e.data.image_url,i.hide(),window.location.reload(!0))}).always(function(){y=!1})):i.hide())}function q(e){e.preventDefault(),window.ps_crop.init({elem:w,change:function(e){m=function(e,o){var t,a,n=(0,d.default)(e),i=1,r=!1;e.naturalWidth&&(t=e.naturalWidth||n.width(),a=e.naturalHeight||n.height(),(800<t||800<a)&&(i=800/Math.max(t,a),t*=i,a*=i,r=!0),i=t/n.width());o={x1:Math.floor(i*o.x),y1:Math.floor(i*o.y),x2:Math.floor(i*(o.x+o.width)),y2:Math.floor(i*(o.y+o.height))},r&&(o.width=t,o.height=a);return o}(w[0],e)}}),p.hide(),l.show(),f.show()}function E(e){e.preventDefault(),window.ps_crop.detach(w),p.show(),l.hide(),f.hide()}function I(e){e.preventDefault(),window.ps_crop.detach(w),p.show(),l.hide(),f.hide();var o={x:m.x1,y:m.y1,x2:m.x2,y2:m.y2,width:m.width,height:m.height};T?o.tmp=1:o.preview=1;e=d.default.extend(o,{u:x,_wpnonce:D});t.ajax.post("groupajax.avatar_crop",e).then(function(e){e.success&&(Q(e.data.image_url),T||(O=o,c.removeAttr("disabled")))})}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(d,e,o){(function(a){(function(){"use strict";var o=t("undefined"!=typeof window?window.jQuery:void 0!==a?a.jQuery:null),n="undefined"!=typeof window?window.peepso:void 0!==a?a.peepso:null,e="undefined"!=typeof window?window.peepsodata:void 0!==a?a.peepsodata:null,i=t(d("./avatar-dialog"));function t(e){return e&&e.__esModule?e:{default:e}}var r=+e.group.id;(0,o.default)(function(){var t,a,e=(0,o.default)(".ps-js-focus--group .ps-js-avatar");e.length&&(t=e.find(".ps-js-avatar-image"),a=e.find(".ps-js-avatar-button-wrapper"),n.hooks.addAction("group_avatar_updated","page_group",function(e,o){+e==r&&t.attr("src",o),o.match(/\/groups\/\d+\//)?(a.css("cursor",""),a.attr("onclick","peepso.simple_lightbox('".concat(o.replace("-full.","-orig."),"'); return false"))):(a.css("cursor","default"),a.removeAttr("onclick"))}),e.find(".ps-js-avatar-button").on("click",function(e){e.preventDefault(),e.stopPropagation(),(0,i.default)().show()}))})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./avatar-dialog":1}],3:[function(e,o,t){(function(o){(function(){"use strict";var e,p=(e="undefined"!=typeof window?window.jQuery:void 0!==o?o.jQuery:null)&&e.__esModule?e:{default:e},l="undefined"!=typeof window?window._:void 0!==o?o._:null,f="undefined"!=typeof window?window.peepso:void 0!==o?o.peepso:null,h="undefined"!=typeof window?window.peepsodata:void 0!==o?o.peepsodata:null;var v=+h.group.id,g=+h.group.module_id,w=h.group.img_cover_default,_=h.group.cover_nonce,m="".concat(h.ajaxurl_legacy,"groupajax.cover_upload?cover"),y=+peepsodata.upload_size,j=h.group.text_cover_error_filetype,x=h.group.text_cover_error_filesize,b=+h.group.has_cover;(0,p.default)(function(){var o,a,n,i,r,d,e,t,s,u,c=(0,p.default)(".ps-js-focus--group .ps-js-cover");c.length&&((0,p.default)(".ps-js-cover-upload").on("click",function(e){e.preventDefault(),o[0].value=null,o.trigger("click")}),e='<input type="file" name="filedata" accept="'.concat("image/*",'" data-name="').concat("group-cover-upload",'" />'),(e=(0,p.default)(e).css({position:"absolute",opacity:0,height:1,width:1})).appendTo(document.body),e.psFileupload({formData:{group_id:v,module_id:g,_wpnonce:_},dataType:"json",url:m,replaceFileInput:!1,add:function(e,o){var t=o.files[0];t.type.match(/image\/(jpe?g|png)$/i)?t.size>y?alert(x):(d.css("opacity",.5),o.submit()):alert(j)},done:function(e,o){var t=o.result;t.success?(o=t.data.image_url,a.show(),n.show(),b=!0,d.attr("style","").attr("src",o+"?"+Math.random()).one("load",s),f.hooks.doAction("group_cover_updated",v,o)):t.errors&&alert(t.errors)}}),o=e,a=(0,p.default)(".ps-js-cover-remove").on("click",function(e){e.preventDefault();var o=(0,f.dialog)(h.group.template_cover_remove).show();o.$el.on("click",".ps-js-cancel",function(){return o.hide()}),o.$el.on("click",".ps-js-submit",function(){o.hide(),d.css("opacity",.5);var e={group_id:v,_wpnonce:_};f.ajax.post("groupajax.cover_delete",e).then(function(e){e.success&&(a.hide(),n.hide(),b=!1,d.attr("style","").attr("src",w).one("load",s),f.hooks.doAction("group_cover_updated",v,w))})})}),n=(0,p.default)(".ps-js-cover-reposition").on("click",function(e){e.preventDefault(),d.data("style",d.attr("style")),d.css("z-index",1),c.addClass("ps-focus-cover-edit"),i.show();var t=r.width()-d.width(),a=r.height()-d.height();d.draggable({cursor:"move",drag:function(e,o){o.position.left=Math.min(0,Math.max(t,o.position.left)),o.position.top=Math.min(0,Math.max(a,o.position.top))},stop:function(e,o){var t=o.position,o=100*t.left/r.width(),t=100*t.top/r.height(),o=Math.ceil(1e4*o)/1e4,t=Math.ceil(1e4*t)/1e4;d.css({left:"".concat(o,"%"),top:"".concat(t,"%")}),d.data({reposX:o,reposY:t})}})}),i=(0,p.default)(".ps-js-cover-reposition-actions").hide(),(0,p.default)(".ps-js-cover-reposition-cancel").on("click",function(e){e.preventDefault(),c.removeClass("ps-focus-cover-edit"),i.hide(),d.css("z-index",""),d.draggable("destroy"),d.attr("style",d.data("style")).removeData("style")}),(0,p.default)(".ps-js-cover-reposition-confirm").on("click",function(e){e.preventDefault(),c.removeClass("ps-focus-cover-edit"),i.hide(),d.css("z-index",""),d.draggable("destroy");e={group_id:v,_wpnonce:_,y:d.data("reposX"),x:d.data("reposY")};f.ajax.post("groupajax.cover_reposition",e)}),r=c.find(".ps-js-cover-wrapper"),d=c.find(".ps-js-cover-image"),b||(n.hide(),a.hide()),s=function(){d.css({height:"auto",width:"100%",minWidth:"100%",maxWidth:"100%"});var e=r.height(),o=r.width(),t=d.height(),a=d.width();t<e&&(d.css({height:"100%",width:"auto",minWidth:"100%",maxWidth:"none"}),t=d.height(),a=d.width());var n=parseFloat(d[0].style.top)||0;e<=t&&n<(i=(t-e)/e*-100)&&d.css("top","".concat(i,"%"));var i,e=parseFloat(d[0].style.left)||0;o<=a&&e<(i=(a-o)/o*-100)&&d.css("left","".concat(i,"%")),d.css("opacity","")},s=(0,l.throttle)(s,500),d.one("load",function(){return s()}).each(function(e,o){return o.complete&&s()}),f.hooks.addAction("browser_resize","group_cover",function(e){t&&t===e.width||(t=e.width,s())}),(u=(0,p.default)(".ps-js-cover-button-popup")).on("click",function(e){e.currentTarget!==e.target||(e=(0,p.default)(this).data("cover-url"))&&peepso.simple_lightbox(e)}),f.hooks.addAction("group_cover_updated","page_group",function(e,o){+e==v&&(-1<o.indexOf("/groups/".concat(e,"/"))?(u.css("cursor","pointer"),u.data("cover-url",o)):(u.css("cursor",""),u.removeData("cover-url")))}))})}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,o,t){"use strict";e("./avatar"),e("./cover")},{"./avatar":2,"./cover":3}],5:[function(e,o,t){"use strict";e("./header")},{"./header":4}]},{},[5]);